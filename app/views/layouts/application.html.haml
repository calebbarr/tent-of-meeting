                                         
!!!
%html
	%head
		/ %title Tent of Meeting 
		= javascript_include_tag 'application'
		= javascript_include_tag "http://localhost:9292/faye.js"
		= javascript_include_tag "http://localhost/colorbox/jquery.colorbox.js"
		= javascript_include_tag "http://localhost/jquery-ui-1.8.18.custom/js/jquery-ui-1.8.18.custom.min.js"
		= csrf_meta_tag
		%meta{:charset => "UTF-8"}
			= stylesheet_link_tag "http://localhost/tent_of_meeting.css"
			= stylesheet_link_tag "http://localhost/jquery-ui-1.8.18.custom/css/smoothness/jquery-ui-1.8.18.custom.css"
			= stylesheet_link_tag "http://localhost/colorbox/colorbox.css"
			:javascript
				$(document).ready(function(){
					bindLayoutButtons(); //should have code to get the object, ... maybe defaults should just be here and this shouldn't be called
					
					$( ".navigation_button" ).button();
					$( ".sidebar_button" ).button();
					$( ".user_navigation_menu_item" ).button();
					$( "#favorite_button" ).button();
					$("#strongs_dropdown")
									.button( {
										text: false,
										icons: {
											primary: "ui-icon-triangle-1-s"
										}
									}).parent().buttonset();
				}) ;
	%body{background: "http://localhost/mountains.jpg"}
		%br
		#containercontainer{align: "center", style: "padding: 20px; background-color: rgba(153, 153, 153, 0.5); border-radius: 20px;width:78%;margin: 0 auto;"}
			
			.container
				%header
					%a{:href => "#"}
					%h1{id: "main_header", align: "center"}
					%nav
						.user_navigation{align: "right", style:"padding-right:5px", :class => "ui-widget-header ui-corner-all"}
							%span{id: "strongs_parent"}
								%span{id: "strongs_button", class: "user_navigation_menu_item", onClick: toggle_original_languages_script, title: "toggle original language"}
									η/ע
								%span{id: "strongs_dropdown", height:"100%", title: "browse strong's", onClick: "browseStrongs()"}
							%span{title: "profile", class: "user_navigation_menu_item", onClick: "profile()"}
								%img{src: "http://localhost/icons/16x16/user.png"}
							%span{title: "settings", class: "user_navigation_menu_item", onClick: "settings()"}
								%img{src: "http://localhost/icons/16x16/folder.png"}
							/@TODO
							/fix because it uses the link_to REST stuff
							%span{class: "user_navigation_menu_item", title: -> {user_signed_in? ? "logout" : "login" }.call, onClick: -> { user_signed_in? ?  "logout('" + destroy_user_session_path + "')" : "login('" + new_user_session_path + "')" }.call }
								%img{src: "http://localhost/icons/16x16/house.png"}
							%span{class: "user_navigation_menu_item"}
								= form_tag verse_search_url, :controller => :verses, :action => :search do
									= search_field_tag(:query, value="", :id => 'search_box')
									= submit_tag nil, :hidden => true
				.sidebar1{style: "height:325px;overflow:scroll;"}
					%nav{align: "right"}
						.sidebar_item
							%button{id: "sidebar_button_1", :class => "sidebar_button", href:"#", title: "audio", onClick: "show_verse_audio()"}
								%img{src: "http://localhost/icons2/32x32/sound.png"}						
						.sidebar_item
							%button{id: "sidebar_button_2", :class => "sidebar_button", onClick: "memorize('"+"/"+@book.name+"/"+@chapter.name.to_s+"/"+@verse.name.to_s+"/memorize"+"')", title: "memorize"}
								%img{src: "http://localhost/icons/32x32/magnifier.png"}
						.sidebar_item
							%button{id: "sidebar_button_3", :class => "sidebar_button", onClick: "quiz('"+ -> { return @verse.has_quiz? ? "/"+@book.name+"/"+@chapter.name.to_s+"/"+@verse.name.to_s+"/quiz" : "/"+@book.name+"/"+@chapter.name.to_s+"/"+@verse.name.to_s+"/quiz/new"}.call + "')" , title: -> {return  @verse.has_quiz? ?  "take quiz" : "create quiz"}.call }
								%img{src: "http://localhost/icons/32x32/check_mark.png"}
						.sidebar_item
							%input{id: "favorite_button", type:"checkbox", checked: -> {@verse.is_favorite?(->{signed_in? ? current_user.id : 1 }.call)}.call, onClick: "toggleFavorite("+@verse.id.to_s+", "+ ->{signed_in? ? current_user.id.to_s : "1" }.call+","+ @verse.is_favorite?(->{signed_in? ? current_user.id : 1 }.call).to_s+")"}
							%label{for: "favorite_button", title: " "+ -> {@verse.is_favorite?(->{signed_in? ? current_user.id : 1 }.call) ? "unfavorite" : "favorite"}.call+ " "}
								%img{src: "http://localhost/icons/32x32/heart.png"}
						%button{id: "sidebar_button_4", :class => "sidebar_button", title: -> {return @verse.has_note?(id = -> {signed_in? ? current_user.id : 1 }.call ) ? "notes" : "new note"}.call, onClick: "verseNotes("+@verse.id.to_s+", "+ -> {return @verse.has_note?(id = -> {signed_in? ? current_user.id : 1 }.call ) ? 'false)' : 'true)'}.call }
							/the 1 here is just a stand-in for session-based code if not authenticated
							/= -> { return @verse.has_note?(id = -> {signed_in? ? current_user.id : 1 }.call ) ?  link_to("_", controller: :notes, action: :show, :verse_id => @verse.id) : link_to("_", controller: :notes, action: :new, :verse_id => @verse.id) }.call
							%img{src: "http://localhost/icons/32x32/pencil.png"}
						.sidebar_item
							%button{:class => "sidebar_button", onClick: "show_related(#{@verse.id})", title: "related"}
								%img{src:"http://localhost/icons/32x32/placemark.png"}

						/ 	%li
						/ 		/the 1 here is just a stand-in for session-based code if not authenticated
						/ 		= -> { return @verse.has_note?(id = -> {signed_in? ? current_user.id : 1 }.call ) ?  link_to("✎", controller: :notes, action: :show, :verse_id => @verse.id) : link_to("✎+", controller: :notes, action: :new, :verse_id => @verse.id) }.call
					/ %aside{style: "height:107px; overflow:scroll;"}
					/ 						%p
					/ 							my friends notes
					/ 						%p etc
					/ 						%p updates i'd be interested in about this page
					/ 						%p testing the scroll
					/ 						%p testing
					/ 						%p 1
					/ end .sidebar1
				%article.content{align: "center" }
					#stage{style:"height:325px; overflow:scroll;"}
						= yield
						#related{align:"center", style: "display:none"}
							= render_cell(:related_verses_cell, :show, {:id => @verse.id})
						#verse_notes{align: "center"}
				%aside
					#chat{style: "height:325px; overflow:scroll"}
						= render_cell :chat , :show
				%footer{align: "center"}
					.block{:class => "ui-widget-header ui-corner-all", style:"width:60%; padding: 10px 4px; border-radius:20px;", align: "center"}
						#controls2{align: "center"}
						%div{id:"navigation_bar", align: "center"}
							%button{:id => "up_arrow_nav", :class => "navigation_button", onClick: "prev_book()", title: "previous book"}
								%img{src: 'http://localhost/icons/32x32/up_arrow.png'}
							%button{:id => "skip_backward_nav",:class => "navigation_button", onClick: "prev_chapter()", title: "previous chapter"}
								%img{src: 'http://localhost/icons2/32x32/skip_backward.png'}
							%button{:id => "rewind_nav",:class => "navigation_button", onClick: "prev_verse()", title: "previous verse"}
								%img{src: 'http://localhost/icons2/32x32/rewind.png'}
							%button{:id => "random_nav",:class => "navigation_button", onClick: "random_verse()", title: "random verse"}
								%img{src: 'http://localhost/icons2/32x32/refresh.png'}
							%button{:id => "fast_forward_nav",:class => "navigation_button", onClick: "next_verse()", title: "next verse"}
								%img{src: 'http://localhost/icons2/32x32/fast_forward.png'}
							%button{:id => "skip_forward_nav",:class => "navigation_button", onClick: "next_chapter()", title: "next chapter"}
								%img{src: 'http://localhost/icons2/32x32/skip_forward.png'}														
							%button{:id => "down_arrow_nav",:class => "navigation_button", onClick: "next_book()", title: "next book"}
								%img{src: 'http://localhost/icons/32x32/down_arrow.png'}
				#flash
					.flash{:align => "center"}
						- flash.each do |type, message|
							%div{:class => "message #{type}"}
								%p= message							